<h1>Post show page </h1>
<p>Title - <%= @post.title %></p>
<p>Destription - <%= @post.description %></p>
<p>Author - <%= @post.user.first_name %>
<p>post-type - <%= @post.post_type %> </p>
<p><%= @post.likes.count %> <%= (@post.likes.count) == 1 ? 'Like' : 'Likes'%></p>

<% pre_like = @post.likes.find { |like| like.user_id == current_user.id} %>
<% if pre_like %>
  <%= button_to 'Unlike', post_like_path(@post, pre_like), method: :delete, remote:true %>
<% else %>
  <%= button_to 'Like', post_likes_path(@post), method: :post ,remote:true%>
<% end %>

  <h3>show all comments</h3>
<% @comments.each do |c| %>
    <p> <%= c.comment %> </p>
    <p> author- <%= c.user.first_name %>  <%= c.user.last_name %> </p>
    <p><%= c.likes.count %> <%= (c.likes.count) == 1 ? 'Like' : 'Likes'%></p>

    <% pre_like = c.likes.find { |like| like.user_id == current_user.id} %>
    <% if pre_like %>
      <%= button_to 'Unlike', post_comment_like_path(@post,c, pre_like), method: :delete, remote:true %>
    <% else %>
      <%= button_to 'Like', post_comment_likes_path(@post,c), method: :post ,remote:true%>
    <% end %>
    <% if can? :update, c %>
      <%= link_to 'edit', edit_post_comment_path(@post,c) %>
    <% end %>
    <% if can? :destroy, c %>
      <%= link_to 'delete', post_comment_path(@post,c) ,method: :delete ,data: {confirm: "are you sure"}%>
    <% end %>
    <p>-------------------------------------------</p>
<% end %>
<br>
<%= form_with(model: [@post,@comment], class: "shadow p-3 mb-3 bg-info rounded", local:false) do |f| %>
  

    <div class="field">
      <%= f.label :comment %><br />
      <%= f.text_field :comment, autofocus: true, autocomplete: "name" %>
    </div>
  
    <div class="actions">
      <%= f.submit "add comment" %>
    </div>
  <% end %>

<br>
<% if can? :update, @post %>
   <%= link_to "edit_post" ,edit_post_path %>
<% end %>

<br>
<% if can? :destroy, @post %>
  <%= link_to "delete_post", post_path, method: :delete, data: {confirm: "are you sure"} %>
<% end %>
<br>
<%= link_to 'back' ,:back %>
<%= link_to 'home' ,root_path %> 